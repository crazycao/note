# 架构

## 路由跳转的实现方式 ？
- 在`+(void)load`方法中注册路由。
	- 但由于会影响启动速度，在项目大了以后，还是改为人工提供路由表（JSON）。
- 创建一个路由模块，管理路由表和路由跳转。
- 使用路由模块跳转时，只需传入URL即可。
	- 通过URL跳转，内部路由和外部路由跳转皆可。URL格式如下。
		- Scheme，以该Scheme开头的URL是用于路由跳转的URL。外部路由跳转时，需要指定Scheme才能打开APP。
		- host，一般为当前应用的bundleID或者公司的域名。可以用于限制只允许哪些域名的跳转。
		- path，对应指向相应的页面。
		- query，传到目标页面的参数，如果是url或中文，应该encode。
	- 对于内部跳转，也可以考虑提供支持传递对象的路由跳转方法。 
- 路由模块在跳转时，首先解析URL，然后与路由表匹配，根据从路由表中获取到的类名，动态生成页面，再获取当前的导航控制器，最后推入生成的页面。

## MVVM 与 MVC 的区别

- MVVM
	- 把VC也归入了View层
	- 将业务逻辑（包括按钮执行逻辑）封装成一个个的 command
	- VM 能主动调用对 Model 做更改，也能在 Model 更新的时候对自身进行调整
	- View 和 VM 之间进行数据绑定，当 VM 自身用于展示的数据发生变化时，View 也相应更新

- 将 C 层拆分
- 把按钮的执行逻辑都封装成了command
- 提高了代码的复用率
- 方便进行单元测试

## iOS APP 的启动过程

- 加载dyld到App进程
	- dyld的全称是dynamic loader，它的作用是加载一个进程所需要的image，dyld是开源的。
- 加载动态库（包括所依赖的所有动态库）
	- 加载动态库A到内存，接着检查A所依赖的动态库，就这样的递归加载，直到所有的动态库加载完毕。
- Rebase，修正内部(指向当前mach-o文件)的指针指向
- Bind，修正外部指针指向。
	- 根据字符串匹配的方式查找符号表，解决外部的符号引用问题 
- 初始化Objective C Runtime
- 其它的初始化代码
	- +(void)load 方法
	- C／C++静态初始化对象和标记为attribute(constructor)的方法
- main函数
- 执行AppDelegate的代理方法，主要是didFinishLaunchingWithOptions
- 初始化Window，初始化基础的ViewController结构(一般是UINavigationController+UITabViewController)
- 获取数据(Local DB／Network)，展示给用户。

## iOS 常用的设计模式有哪些

- 代理模式（Delegate）
	- 当一个类的某些功能需要由别的类来实现，就把需求代理出去。
- 工厂模式（Factory）
	- 父类定义创建对象的接口，让子类决定实例化哪一个类。 
	- 针对每一种产品提供一个工厂类。通过不同的工厂类来创建不同的产品实例。
- 单例模式（Singleton）
	- 保证一个类仅有一个实例，并提供一个访问它的全局访问点。
	- 单例用来集中管理对类的对象所提供的资源。
- 适配器模式（Adapter）
	- 将一个类的接口转换成客户希望的另一个接口，适配器模式使得原本由于接口不兼容而不能一起工作的那些类可以一起工作。
- 观察者模式（Observer）
	- 定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并自动更新。
	- 通知和 KVO 都实现了观察者模式。   

## iOS 14 的新特性有哪些

1. 小组件（Widgets）
	- 可以将小组件添加到主屏幕。
	- 新的小组件支持智能叠放功能，它可以在不同的时间呈现不同的小组件。
	- 开放了一个新的框架WidgetKit，用来开发小组件。
2. App资源库（App Library）
	- 新增一个 App 资源库界面，可以把你的App自动整理起来。
	- 在页面的最后一页(右滑最后一页)。
3. 画中画（Picture in Picture）
	- 以前在iPad中，这次添加到了iPhone上。
	- 在把App放到后台之后，屏幕上会出现一个悬浮窗口播放功能。 
	- 用户可以调节视频窗口大小。
4. 紧凑
	- 来电显示不再占用整个屏幕，而只是屏幕上方的一小块。
	- Siri不再占用整个屏幕，而只是屏幕底部的一个标志。
5. 翻译（Translate）
	- 苹果新推出了一款简单易用的翻译软件
	- 可以离线使用，支持中文、英语等11种语言  
6. 轻APP（App Clip）
	- 它是App的一小部分， 支持苹果支付和苹果登录功能
	- 可以通过浏览器启动、短信消息、Maps、NFC、或者二维码打开App Clip。
	- Xcode和最新SDK的全部功能开放，就是可以自定义小程序，功能不单一