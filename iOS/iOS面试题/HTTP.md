# HTTP

## HTTP与HTTPS的区别

### 传输信息安全性不同

- HTTP：超文本传输协议，信息是明文传输。
	- 如果攻击者截取了Web浏览器和网站服务器之间的传输报文，就可以直接读懂其中的信息。
- HTTPS：由SSL＋HTTP协议构建的可进行加密传输、身份认证的网络协议。
	- SSL：安全套接字层(Secure Socket Layer) 。位于 TCP/IP 协议与各种应用层协议之间，为数据通讯提供安全支持。

### 端口不同

- HTTP：80
- HTTPS：443

> **HTTPS 的数据传输流程**
> 
> 1. Client -> Server: 发送 HTTPS 请求
> 2. Server: 生成一对非对称加密的公私钥（如 RSA）
> 3. Server -> Client: 返回服务端公钥和数字证书
> 4. Client: 客户端校验数字证书，如果校验失败则请求关闭
> 5. Client: 客户端自己生成一对对称加密的密钥（如 AES），并用服务端公钥加密
> 6. Client -> Server: 发送公钥加密的客户端密钥
> 7. Server: 使用服务端私钥解密，获得客户端密钥
> 8. Server: 使用客户端密钥加密传输内容
> 9. Server -> Client: 返回用客户端秘钥加密的报文
> 10. Client: 使用客户端秘钥解密报文，完成通信

## HTTP 2.0 有哪些新特性

- 二进制格式
	- HTTP 1.x 基于文本解析，HTTP 2.0 基于二进制解析
	- 文本的表现形式有多样性，二进制则只有0和1的组合，这样实现方便且健壮。
- 多路复用
	- 多个 request 可以共享一个连接
	- 每个 request 对应一个 id，这样一个连接上可以有多个 request，每个连接的 request 可以随机的混杂在一起，接收方可以根据 request 的 id 将 request 再归属到各自不同的服务端请求里面
- header压缩
	- HTTP2.0使用encoder来减少需要传输的header大小，通讯双方各自cache一份header fields表，既避免了重复header的传输，又减小了需要传输的大小
- 服务端推送
	- HTTP2.0也具有server push功能
	- 服务端推送能把客户端所需要的资源伴随着index.html一起发送到客户端，省去了客户端重复请求的步骤。

## HTTP 协议中 POST 和 GET 的区别

- GET一般用于获取/查询资源信息，而POST一般用于更新资源信息。
- GET应该是安全的和幂等的，而POST表示可能修改变服务器上的资源的请求。
- GET请求的数据会附在URL之后(query)，而POST则把提交的数据放置在是HTTP包的包体(body)中。
- GET提交数据的长度受URL长度限制（一般是浏览器对URL长度有限制），而POST数据一般是没有限制的。
- POST的安全性要比GET的安全性高。（略微高一点点）
	- 通过GET提交数据，用户名和密码将明文出现在URL上，因为①登录页面有可能被浏览器缓存，②其他人查看浏览器的历史纪录，那么别人就可以拿到你的账号和密码了。

## HTTP请求报文与响应报文格式

- 请求报文包含四部分：
	- 请求行：包含请求方法、URI、HTTP版本信息
	- 请求头
	- 请求内容实体
	- 空行

- 响应报文包含四部分：
	- 状态行：包含HTTP版本、状态码、状态码的原因短语
	- 响应头
	- 响应内容实体
	- 空行

## Socket 

> 套接字（socket）是支持TCP/IP协议的网络通信的基本操作单元。
> 
> 它是网络通信过程中端点的抽象表示，包含进行网络通信必须的五种信息：
> 
> 1）连接使用的协议，
> 2）本地主机的IP地址，
> 3）本地进程的协议端口，
> 4）远地主机的IP地址，
> 5）远地进程的协议端口。

建立Socket连接至少需要一对套接字：ServerSocket 和 ClientSocket

- 套接字之间的连接过程分为三个步骤：服务器监听，客户端请求，连接确认。
	- 服务器监听：
		- 服务器端套接字并不定位具体的客户端套接字，而是处于等待连接的状态，实时监控网络状态，等待客户端的连接请求。 
	- 客户端请求：
		- 指客户端的套接字提出连接请求，要连接的目标是服务器端的套接字。
		- 为此，客户端的套接字必须首先描述它要连接的服务器的套接字，指出服务器端套接字的地址和端口号，然后就向服务器端套接字提出连接请求。
	- 连接确认：
		- 当服务器端套接字监听到或者说接收到客户端套接字的连接请求时，就响应客户端套接字的请求，建立一个新的线程，把服务器端套接字的描述发给客户端。
		- 一旦客户端确认了此描述，双方就正式建立连接。
		- 而服务器端套接字继续处于监听状态，继续接收其他客户端套接字的连接请求。

### Socket连接与TCP连接

- 创建Socket连接时，可以指定使用的传输层协议
- Socket可以支持不同的传输层协议（TCP或UDP）
- 当使用TCP协议进行连接时，该Socket连接就是一个TCP连接

### Socket连接与HTTP连接

- 通常情况下Socket连接就是TCP连接，因此Socket连接一旦建立，通信双方即可开始相互发送数据内容，直到双方连接断开
	- 大部分防火墙默认会关闭长时间处于非活跃状态的连接而导致 Socket 连接断连，因此需要通过轮询告诉网络，该连接处于活跃状态。
- HTTP连接使用的是“请求—响应”的方式，不仅在请求时需要先建立连接，而且需要客户端向服务器发出请求后，服务器端才能回复数据。
	- 有的设计中，客户端也会定时向服务器端发送连接请求，不仅可以保持在线，同时也是在“询问”服务器是否有新的数据，如果有就将数据传给客户端。 