# React 哲学 —— 开发思路


## 第一步：将设计好的 UI 划分为组件层级

**首先，在设计稿上用方框圈出每一个组件（包括它们的子组件），并且以合适的名称命名。**

根据 **单一功能原则** 来判定组件的范围。也就是说，一个组件原则上只能负责一个功能。如果它需要负责更多的功能，这时候就应该考虑将它拆分成更小的组件。

**然后，将把它们描述为更加清晰的层级。**设计稿中被其他组件包含的子组件，在层级上应该作为其子节点。

## 第二步：用 React 创建一个静态版本

**先用已有的数据模型渲染一个不包含交互功能的 UI。**

将渲染 UI 和添加交互这两个过程分开。这是因为，编写一个应用的静态版本时，往往要编写大量代码，而不需要考虑太多交互细节；添加交互功能时则要考虑大量细节，而不需要编写太多代码。

在构建应用的静态版本时，我们需要创建一些会重用其他组件的组件，然后通过 props 传入所需的数据。props 是父组件向子组件传递数据的方式。

完全不应该使用 state 构建静态版本。state 代表了随时间会产生变化的数据，应当仅在实现交互时使用。

当你的应用比较**简单时**，使用**自上而下**（首先编写层级较高的组件）的方式更方便；对于**较为大型的项目**来说，**自下而上**（从最基本的组件开始编写）地构建，并同时为低层组件编写测试是更加简单的方式。

这些组件目前只需提供 `render()` 方法用于渲染。**最顶层的组件通过 props 接受你的数据模型。**如果你的数据模型发生了改变，再次调用 `ReactDOM.render()`，UI 就会相应地被更新。

React **单向数据流**（也叫单向绑定）的思想使得组件模块化，易于快速开发。

## 第三步：确定 UI state 的最小（且完整）表示

想要使你的 UI 具备交互功能，需要有触发基础数据模型改变的能力。

**首先需要找出应用所需的 state 的最小表示**，并根据需要计算出其他所有数据。只保留应用所需的可变 state 的最小集合，其他数据均由它们计算产生。Don’t Repeat Yourself。

通过问自己以下三个问题，你可以逐个检查相应数据是否属于 state：

- 该数据是否是由父组件通过 props 传递而来的？如果是，那它应该不是 state。
- 该数据是否随时间的推移而保持不变？如果是，那它应该也不是 state。
- 你能否根据其他 state 或 props 计算出该数据的值？如果是，那它也不是 state。

## 第四步：确定 state 放置的位置

接下来，我们需要确定哪个组件能够改变这些 state，或者说拥有这些 state。

可以尝试通过以下步骤来判断：

对于应用中的每一个 state：

- 找到根据这个 state 进行渲染的所有组件。
- 找到他们的共同所有者（common owner）组件（在组件层级上高于所有需要该 state 的组件）。
- 该共同所有者组件或者比它层级更高的组件应该拥有该 state。
- 如果你找不到一个合适的位置来存放该 state，就可以直接创建一个新的组件来存放该 state，并将这一新组件置于高于共同所有者组件层级的位置。

## 第五步：添加反向数据流

数据反向传递：处于较低层级的组件更新较高层级的组件中的 state。

React 通过一种比传统的双向绑定略微繁琐的方法来实现反向数据传递。尽管如此，但这种需要显式声明的方法更有助于人们理解程序的运作方式。